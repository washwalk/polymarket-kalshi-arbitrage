(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{3626:(e,t,r)=>{Promise.resolve().then(r.bind(r,6500))},6500:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c});var n=r(4568),l=r(7620);function c(){let{bpm:e,isRunning:t,start:r,stop:c,handleTapTempo:o,halfBpm:a,doubleBpm:u,handleRandomMuting:s,randomMuteProbability:i}=function(){let[e,t]=(0,l.useState)(40),[r,n]=(0,l.useState)(!1),[c,o]=(0,l.useState)(0),a=(0,l.useRef)(null),u=(0,l.useRef)(null),s=(0,l.useRef)(0),i=(0,l.useRef)(0),d=(0,l.useRef)(0),m=(0,l.useRef)(40),x=(0,l.useRef)(!1),g=(0,l.useRef)(0),h=(0,l.useCallback)(e=>{var t;if(console.log("Playing click at scheduled time:",e,"current time:",null==(t=a.current)?void 0:t.currentTime),!a.current)return void console.log("No audio context");if("suspended"===a.current.state){console.log("Audio context suspended, attempting resume"),a.current.resume().catch(e=>console.error("Resume failed in playClick:",e));return}let r=a.current.currentTime;if(e<r&&(console.log("Time in past, adjusting to current:",e,"->",r),e=r),!(g.current>0&&Math.random()<g.current))try{console.log("Creating oscillator");let t=a.current.createOscillator(),r=a.current.createGain();t.connect(r),r.connect(a.current.destination),t.frequency.setValueAtTime(1e3,e),t.type="square",r.gain.setValueAtTime(0,e),r.gain.linearRampToValueAtTime(.3,e+.001),r.gain.exponentialRampToValueAtTime(.001,e+.05),t.start(e),t.stop(e+.05),console.log("Web Audio click played at time:",e,"frequency:",1e3)}catch(e){console.error("Error playing Web Audio:",e)}},[]),p=(0,l.useCallback)(()=>{if(console.log("scheduler running"),!a.current)return void console.log("no audio context in scheduler");let e=a.current.currentTime+.1;for(console.log("nextNoteTime:",s.current,"threshold:",e);s.current<e;)console.log("scheduling click at",s.current,"currentTime:",a.current.currentTime),h(s.current),s.current+=60/m.current},[h]),f=(0,l.useCallback)(()=>{console.log("timerLoop running, isRunningRef:",x.current),x.current&&p()},[p]),b=(0,l.useCallback)(()=>{if(r)return;a.current&&"closed"!==a.current.state||(a.current=new(window.AudioContext||window.webkitAudioContext));let t=a.current,l=t.createOscillator(),c=t.createGain();if(l.frequency.setValueAtTime(440,t.currentTime),c.gain.setValueAtTime(.001,t.currentTime),c.gain.exponentialRampToValueAtTime(1e-5,t.currentTime+.02),l.connect(c),c.connect(t.destination),l.start(t.currentTime),l.stop(t.currentTime+.02),"suspended"===t.state&&t.resume(),"running"!==t.state)return void console.error("iOS audio unlock failed - context state:",t.state);x.current=!0,m.current=e,s.current=t.currentTime+.05,n(!0),u.current=setInterval(f,10)},[r,e,f]),T=(0,l.useCallback)(()=>{x.current=!1,n(!1),u.current&&clearInterval(u.current)},[]),k=(0,l.useCallback)(()=>{if(!r||!a.current)return;let e=a.current.currentTime;if(d.current++,1===d.current)i.current=e;else if(2===d.current){let r=Math.max(30,Math.min(300,Math.round(60/(e-i.current))));m.current=r,console.log("Tap BPM set to:",r),t(r),d.current=0}},[r]),v=(0,l.useCallback)(()=>{t(e=>{let t=Math.max(1,Math.round(e/2));return m.current=t,console.log("BPM halved to:",t),t})},[]),N=(0,l.useCallback)(()=>{t(e=>{let t=Math.min(300,Math.round(2*e));return m.current=t,console.log("BPM doubled to:",t),t})},[]),w=(0,l.useCallback)(()=>{if(!r)return;let e=window.prompt("Enter random mute percentage (0-100):",Math.round(100*c).toString());if(null!==e){let t=parseInt(e,10);if(!isNaN(t)&&t>=0&&t<=100){let e=t/100;g.current=e,o(e),console.log("Random mute set to:",t,"%")}}},[r,c]);return(0,l.useEffect)(()=>()=>{u.current&&clearInterval(u.current),a.current&&a.current.close()},[]),{bpm:e,isRunning:r,start:b,stop:T,handleTapTempo:k,halfBpm:v,doubleBpm:N,handleRandomMuting:w,randomMuteProbability:c}}(),[d,m]=(0,l.useState)("SPACE = start");return console.log("Current BPM in UI:",e),(0,l.useEffect)(()=>{t?m("Use buttons below or: T=tap tempo | H=half | D=double | R=random mute | SPACE=stop"):m("Use START button below or press SPACE")},[t]),(0,l.useEffect)(()=>{let e=e=>{switch(console.log("Key pressed:",e.code),e.code){case"Space":e.preventDefault(),t?c():r();break;case"KeyT":t&&o();break;case"KeyH":console.log("Halving BPM"),a();break;case"KeyD":console.log("Doubling BPM"),u();break;case"KeyR":t&&s()}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[t,r,c,o,a,u,s]),(0,n.jsx)("section",{className:"max-w-5xl mx-auto px-6 py-20",children:(0,n.jsxs)("div",{className:"flex flex-col items-center gap-12",children:[(0,n.jsxs)("div",{className:"text-center space-y-2",children:[(0,n.jsx)("h1",{className:"text-4xl font-semibold tracking-tight text-white",children:"Clik"}),(0,n.jsx)("p",{className:"text-neutral-400",children:"A free, minimal metronome app."})]}),(0,n.jsxs)("div",{className:"bg-neutral-900/50 rounded-xl p-8 border border-neutral-800",children:[(0,n.jsxs)("div",{className:"text-center space-y-4",children:[(0,n.jsxs)("div",{className:"text-5xl font-bold text-emerald-500",children:[e," BPM"]}),(0,n.jsx)("div",{className:"text-lg text-neutral-300",children:t?"RUNNING":"STOPPED"}),i>0&&(0,n.jsxs)("div",{className:"text-sm text-neutral-400",children:["Random mute: ",Math.round(100*i),"%"]})]}),(0,n.jsx)("div",{className:"mt-8 text-center text-sm text-neutral-400 font-mono",children:d}),(0,n.jsxs)("div",{className:"mt-8 flex justify-center gap-4",children:[(0,n.jsx)("button",{onClick:t?c:r,className:"px-8 py-3 bg-emerald-500 text-black font-bold rounded-lg hover:bg-emerald-400 transition",children:t?"STOP":"START"}),t&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{onClick:o,className:"px-6 py-3 bg-neutral-700 text-white rounded-lg hover:bg-neutral-600",children:"TAP"}),(0,n.jsx)("button",{onClick:a,className:"px-6 py-3 bg-neutral-700 text-white rounded-lg hover:bg-neutral-600",children:"\xbd"}),(0,n.jsx)("button",{onClick:u,className:"px-6 py-3 bg-neutral-700 text-white rounded-lg hover:bg-neutral-600",children:"\xd72"}),(0,n.jsx)("button",{onClick:s,className:"px-6 py-3 bg-neutral-700 text-white rounded-lg hover:bg-neutral-600",children:"MUTE"})]})]})]})]})})}}},e=>{e.O(0,[587,18,358],()=>e(e.s=3626)),_N_E=e.O()}]);